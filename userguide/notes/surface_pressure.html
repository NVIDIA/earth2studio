
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../../_static/favicon.ico" rel="icon" type="image/x-icon">
    <title>Surface pressure interpolation &#8212; Earth2Studio 0.11.0a0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/nvidia-sphinx-theme.css?v=a9229f12" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=c2fa852a"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'userguide/notes/surface_pressure';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/NVIDIA/earth2studio/gh-pages/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'main';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.11" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/NVIDIA-Logo-V-ForScreen-ForLightBG.png" class="logo__image only-light" alt=""/>
    <img src="../../_static/NVIDIA-Logo-V-ForScreen-ForDarkBG.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">Earth2Studio</p>
  
</a></div>
    
      <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../modules/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/NVIDIA/earth2studio/tree/main/recipes">
    Recipes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/NVIDIA/earth2studio/blob/main/CHANGELOG.md">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/earth2studio" title="Github" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Github</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../modules/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/NVIDIA/earth2studio/tree/main/recipes">
    Recipes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/NVIDIA/earth2studio/blob/main/CHANGELOG.md">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/earth2studio" title="Github" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Github</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Surface pressure interpolation</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="surface-pressure-interpolation">
<h1>Surface pressure interpolation<a class="headerlink" href="#surface-pressure-interpolation" title="Link to this heading">#</a></h1>
<p>This documentation describes the surface pressure interpolation provided by <code class="docutils literal notranslate"><span class="pre">earth2studio.models.dx.derived.DerivedSurfacePressure</span></code>.</p>
<section id="variables">
<h2>Variables<a class="headerlink" href="#variables" title="Link to this heading">#</a></h2>
<p>The following variables are used below:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Symbol</strong></p></th>
<th class="head"><p><strong>Variable</strong></p></th>
<th class="head"><p><strong>Value (if constant)</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(g\)</span></p></td>
<td><p>Gravitational acceleration</p></td>
<td><p><span class="math notranslate nohighlight">\(9.8067\ \mathrm{m\,s^{-2}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(R_\mathrm{s}\)</span></p></td>
<td><p>Gas constant for dry air</p></td>
<td><p><span class="math notranslate nohighlight">\(287.053\ \mathrm{J\,kg^{-1}\, K^{-1}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(L\)</span></p></td>
<td><p>Average temperature lapse rate</p></td>
<td><p><span class="math notranslate nohighlight">\(-6.5 \times 10^{-3}\ \mathrm{K\,m^{-1}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
<td><p>Pressure</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\rho\)</span></p></td>
<td><p>Density</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(h\)</span></p></td>
<td><p>Height</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Phi\)</span></p></td>
<td><p>Geopotential</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td><p>Temperature</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(L_\Phi\)</span></p></td>
<td><p>Lapse rate w.r.t. geopotential <span class="math notranslate nohighlight">\(L/g\)</span></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta\)</span></p></td>
<td><p>Inverse temperature <span class="math notranslate nohighlight">\(T^{-1}\)</span></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="physical-basis">
<h2>Physical basis<a class="headerlink" href="#physical-basis" title="Link to this heading">#</a></h2>
<p>The rate of pressure change by altitude is given by the hydrostatic equation, which can be written as</p>
<div class="math notranslate nohighlight">
\[    \mathrm{d}p = -g \rho \, \mathrm{d}h = -\rho \, d\Phi.\]</div>
<p>When combined with the ideal gas law</p>
<div class="math notranslate nohighlight">
\[p = \rho R_\mathrm{s} T\]</div>
<p>we get</p>
<div class="math notranslate nohighlight">
\[\frac{\mathrm{d}p}{\mathrm{d}\Phi} = -\frac{p}{R_\mathrm{s}T}\]</div>
<p>which is equivalent to</p>
<div class="math notranslate nohighlight" id="equation-eq-log-p-deriv">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-log-p-deriv" title="Link to this equation">#</a></span>\[\frac{\mathrm{d}\log p}{\mathrm{d}\Phi} = -\frac{1}{R_\mathrm{s}T}\]</div>
</section>
<section id="log-linear-interpolation">
<h2>Log-linear interpolation<a class="headerlink" href="#log-linear-interpolation" title="Link to this heading">#</a></h2>
<p>The relative change of temperature by altitude, when expressed as absolute temperature
(i.e. in Kelvin), is rather slow: for example, a <span class="math notranslate nohighlight">\(10~\mathrm{K}\)</span> change in
temperature is only <span class="math notranslate nohighlight">\(\approx 3.6\%\)</span> at <span class="math notranslate nohighlight">\(273.15 K = 0~°\mathrm{C}\)</span>.
Therefore, a reasonable first-order approximation is to assume that <span class="math notranslate nohighlight">\(T\)</span> is
constant over a short interval and thus, by Eq. <a class="reference internal" href="#equation-eq-log-p-deriv">(1)</a>, so is
<span class="math notranslate nohighlight">\(\frac{\mathrm{d}\log p}{\mathrm{d}\Phi}\)</span>. Under this approximation,
<span class="math notranslate nohighlight">\(\log p\)</span> has constant slope with respect to <span class="math notranslate nohighlight">\(\Phi\)</span> and the integral</p>
<div class="math notranslate nohighlight">
\[\int_{\Phi_0}^{\Phi}\frac{\mathrm{d}\log p}{\mathrm{d}\Phi} \, \mathrm{d}\Phi\]</div>
<p>in the interval <span class="math notranslate nohighlight">\(\Phi_0 \leq \Phi \leq \Phi_1\)</span> can be computed by linear interpolation as</p>
<div class="math notranslate nohighlight" id="equation-eq-log-linear-interp">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-log-linear-interp" title="Link to this equation">#</a></span>\[\log p(\Phi) = \log p_0 + \frac{\Phi - \Phi_0}{\Phi_1 - \Phi_0} (\log p_1 - \log p_0)\]</div>
<p>where <span class="math notranslate nohighlight">\(p_0 = p(\Phi_0)\)</span> and <span class="math notranslate nohighlight">\(p_1 = p(\Phi_1)\)</span> are the known values of
pressure at the ends of the interval.</p>
</section>
<section id="second-order-correction-for-temperature-lapse-rate">
<h2>Second-order correction for temperature lapse rate<a class="headerlink" href="#second-order-correction-for-temperature-lapse-rate" title="Link to this heading">#</a></h2>
<p>Typically, the temperature locally changes at an approximately linear rate as a function
of altitude, and thus the slope of <span class="math notranslate nohighlight">\(\log p\)</span> is not exactly constant. We can model
the temperature around <span class="math notranslate nohighlight">\(\Phi_\mathrm{m} = \frac{1}{2}(\Phi_0+\Phi_1)\)</span> as</p>
<div class="math notranslate nohighlight" id="equation-eq-lapse-rate">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-lapse-rate" title="Link to this equation">#</a></span>\[T(\Phi) = T_\mathrm{m} + \frac{L}{g}(\Phi-\Phi_\mathrm{m}) = T_\mathrm{m} + L_\Phi(\Phi-\Phi_\mathrm{m})\]</div>
<p>where <span class="math notranslate nohighlight">\(T_\mathrm{m} = T(\Phi_m)\)</span>. Plugging this into Eq. <a class="reference internal" href="#equation-eq-log-p-deriv">(1)</a>
makes it complicated to solve as <span class="math notranslate nohighlight">\(T\)</span> is in the denominator. However, we can
instead use the inverse temperature <span class="math notranslate nohighlight">\(\beta = T^{-1}\)</span>, which can also be
approximated to have a linear relationship with <span class="math notranslate nohighlight">\(\Phi\)</span>. This can be justified with
the Taylor series of the inverse of Eq. <a class="reference internal" href="#equation-eq-lapse-rate">(3)</a> at <span class="math notranslate nohighlight">\(\Phi_\mathrm{m}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\beta(\Phi) =
\frac{1}{T_\mathrm{m}}\left (1 - \frac{L_\Phi (\Phi-\Phi_\mathrm{m})}{T_\mathrm{m}} +
O\left ( \left (\frac{L_\Phi (\Phi-\Phi_\mathrm{m})}{T_\mathrm{m}} \right )^2
\right ) \right )\]</div>
<p>Thus for small relative variations of temperature we can model <span class="math notranslate nohighlight">\(\beta\)</span> as:</p>
<div class="math notranslate nohighlight">
\[\beta(\Phi) = \frac{1}{T} = \frac{1}{T_\mathrm{m}} - \frac{L_\Phi (\Phi-\Phi_\mathrm{m})}{T_\mathrm{m}^2}\]</div>
<p>Equation <a class="reference internal" href="#equation-eq-log-p-deriv">(1)</a> then becomes</p>
<div class="math notranslate nohighlight" id="equation-log-p-deriv-corr">
<span class="eqno">(4)<a class="headerlink" href="#equation-log-p-deriv-corr" title="Link to this equation">#</a></span>\[\frac{\mathrm{d}\log p}{\mathrm{d}\Phi} = -\frac{1}{R_\mathrm{s}T_\mathrm{m}} + \frac{L_\Phi(\Phi-\Phi_\mathrm{m})}{R_\mathrm{s}T_\mathrm{m}^2}\]</div>
<p>The first term on the right-hand side is identical to Eq. <a class="reference internal" href="#equation-eq-log-p-deriv">(1)</a>, so we
can compute it using the log-linear interpolation of Eq. <a class="reference internal" href="#equation-eq-log-linear-interp">(2)</a> and
consider the second term as a correction</p>
<div class="math notranslate nohighlight" id="equation-log-p-corr">
<span class="eqno">(5)<a class="headerlink" href="#equation-log-p-corr" title="Link to this equation">#</a></span>\[\Delta \log p = \frac{L_\Phi(\Phi-\Phi_\mathrm{m})}{R_\mathrm{s}T_\mathrm{m}^2}\]</div>
<p>Within an interval <span class="math notranslate nohighlight">\(\Phi_0 \leq \Phi \leq \Phi_1\)</span> where the pressure is known at
the endpoints <span class="math notranslate nohighlight">\((\Phi_0, \Phi_1)\)</span>, we know that the correction should be zero at
those endpoints. Also, the integration of a linear relationship will give a quadratic
function. The only function that satisfies those constraints is of the form</p>
<div class="math notranslate nohighlight">
\[\Delta \log p = c(\Phi-\Phi_0)(\Phi-\Phi_1)\]</div>
<p>and the derivative of this is</p>
<div class="math notranslate nohighlight">
\[\frac{\mathrm{d}\Delta \log p}{\mathrm{d}\Phi} =
c((\Phi-\Phi_0) + (\Phi-\Phi_1)) = 2c(\Phi - \Phi_m)\]</div>
<p>Comparing this to Eq. <a class="reference internal" href="#equation-log-p-deriv-corr">(4)</a> shows that we should have</p>
<div class="math notranslate nohighlight">
\[c = \frac{L_\Phi}{2R_\mathrm{s}T_\mathrm{m}^2} = \frac{L}{2gR_\mathrm{s}T_\mathrm{m}^2}\]</div>
</section>
<section id="empirical-correction">
<h2>Empirical correction<a class="headerlink" href="#empirical-correction" title="Link to this heading">#</a></h2>
<p>In principle, we could compute the lapse rate <span class="math notranslate nohighlight">\(L_\Phi\)</span> from the temperature of the
endpoints of the interpolation interval. However, this does not seem to yield good
results in practice. This may be because differences like this (similar to numerical
derivatives) tend to be sensitive to noise, or because the near-surface temperature is
often affected by the surface. We get better results by using the average lapse rate of
<span class="math notranslate nohighlight">\(-6.5 \times 10^3\ \mathrm{K\,m^{-1}}\)</span>.</p>
<p>Applying the correction from Eq.~(\ref{eq:correction_approx}) using the average lapse
rate improves the approximation result but leaves some remaining bias and room for
improvement in the mean square error (MSE). To reduce this, we apply a further linear
correction</p>
<div class="math notranslate nohighlight">
\[    (\Delta \log_p)_\mathrm{adj} = a + b\Delta \log_p\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are chosen empirically to minimize the MSE of the
approximated surface pressure over one year of ERA5 data. This analysis gives
<span class="math notranslate nohighlight">\(a = 3.4257 \times 10^{-5}\)</span> and <span class="math notranslate nohighlight">\(b = 1.5224\)</span>. Equivalently, the value of <span class="math notranslate nohighlight">\(b\)</span>
indicates that the optimal assumed lapse rate is
<span class="math notranslate nohighlight">\(-9.9 \times 10^3\ \mathrm{K\,m^{-1}}\)</span>. This is within the physical range of variability but corresponds
to a highly unstable atmosphere. Therefore it seems that the correction also compensates
some other errors besides that due to varying temperature.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables">Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#physical-basis">Physical basis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#log-linear-interpolation">Log-linear interpolation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#second-order-correction-for-temperature-lapse-rate">Second-order correction for temperature lapse rate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#empirical-correction">Empirical correction</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/userguide/notes/surface_pressure.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, NVIDIA.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>