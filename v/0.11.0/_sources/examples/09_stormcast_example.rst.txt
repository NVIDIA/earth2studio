
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/09_stormcast_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_09_stormcast_example.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_09_stormcast_example.py:


Running StormCast Inference
===========================

Basic StormCast inference workflow.

This example will demonstrate how to run a simple inference workflow to generate a
basic determinstic forecast using StormCast. For details about the stormcast model,
see

 - https://arxiv.org/abs/2408.10958

.. GENERATED FROM PYTHON SOURCE LINES 31-38

.. code-block:: Python

    # /// script
    # dependencies = [
    #   "earth2studio[data,stormcast] @ git+https://github.com/NVIDIA/earth2studio.git@0.11.0",
    #   "cartopy",
    # ]
    # ///








.. GENERATED FROM PYTHON SOURCE LINES 39-44

Set Up
------
All workflows inside Earth2Studio require constructed components to be
handed to them. In this example, let's take a look at the most basic:
:py:meth:`earth2studio.run.deterministic`.

.. GENERATED FROM PYTHON SOURCE LINES 46-50

.. literalinclude:: ../../earth2studio/run.py
   :language: python
   :start-after: # sphinx - deterministic start
   :end-before: # sphinx - deterministic end

.. GENERATED FROM PYTHON SOURCE LINES 52-61

Thus, we need the following:

- Prognostic Model: Use the built in StormCast Model :py:class:`earth2studio.models.px.StormCast`.
- Datasource: Pull data from the HRRR data api :py:class:`earth2studio.data.HRRR`.
- IO Backend: Let's save the outputs into a Zarr store :py:class:`earth2studio.io.ZarrBackend`.

StormCast also requires a conditioning data source. We use a forecast data source here,
GFS_FX :py:class:`earth2studio.data.GFS_FX` which is the default, but a non-forecast
data source such as ARCO could also be used with appropriate time stamps.

.. GENERATED FROM PYTHON SOURCE LINES 63-93

.. code-block:: Python

    from datetime import datetime, timedelta

    from loguru import logger
    from tqdm import tqdm

    logger.remove()
    logger.add(lambda msg: tqdm.write(msg, end=""), colorize=True)

    import os

    os.makedirs("outputs", exist_ok=True)
    from dotenv import load_dotenv

    load_dotenv()  # TODO: make common example prep function

    from earth2studio.data import HRRR
    from earth2studio.io import ZarrBackend
    from earth2studio.models.px import StormCast

    # Load the default model package which downloads the check point from NGC
    # Use the default conditioning data source GFS_FX
    package = StormCast.load_default_package()
    model = StormCast.load_model(package)

    # Create the data source
    data = HRRR()

    # Create the IO handler, store in memory
    io = ZarrBackend()








.. GENERATED FROM PYTHON SOURCE LINES 94-102

Execute the Workflow
--------------------
With all components initialized, running the workflow is a single line of Python code.
Workflow will return the provided IO object back to the user, which can be used to
then post process. Some have additional APIs that can be handy for post-processing or
saving to file. Check the API docs for more information.

For the forecast we will predict for 4 hours

.. GENERATED FROM PYTHON SOURCE LINES 104-113

.. code-block:: Python

    import earth2studio.run as run

    nsteps = 4
    today = datetime.today() - timedelta(days=1)
    date = today.isoformat().split("T")[0]
    io = run.deterministic([date], nsteps, model, data, io)

    print(io.root.tree())





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    2025-12-17 14:17:16.423 | INFO     | earth2studio.run:deterministic:75 - Running simple workflow!
    2025-12-17 14:17:16.424 | INFO     | earth2studio.run:deterministic:82 - Inference device: cuda
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.154 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfsfcf00.grib2 44409925-2381615
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.157 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 195856545-814590
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.159 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 123179984-2200050
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.161 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 92670872-1033143
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.163 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 106633622-1029359
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.164 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 195031855-824690
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.166 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 109638785-2227997
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.169 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 169412226-971340
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.171 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 61347492-1056167
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.172 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 104282182-1357304
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.174 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 118131621-1317011
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.176 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 105639486-994136
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.177 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 4420119-2298890
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.179 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 354980719-1419164
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.181 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 119448632-956588
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.182 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 170383566-1051763
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.184 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 18000446-2356017
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.185 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 308658193-772973
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.187 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 89251116-1053514
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.188 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 193472007-1559848
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.190 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 192546623-925384
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.191 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 75260367-1047747
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.192 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 72808105-2452262
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.193 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 309431166-774720
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.194 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfsfcf00.grib2 37135846-1240565
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.195 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 245787370-2210724
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.196 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 141692425-2505255
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.197 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 54155361-2236841
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.198 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 76308114-1343713
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.199 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 172303244-864213
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.200 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 36285606-1179673
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.201 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 117098760-1032861
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.202 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 49915840-1125861
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.203 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 252109708-816593
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.205 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 128225692-2504837
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.206 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 356399883-645797
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.207 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 77651827-1033172
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.208 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 254802479-749751
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.209 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 7861231-1327007
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.210 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 13529073-2242102
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.210 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfsfcf00.grib2 25138026-629918
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.211 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 40621604-2239738
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.212 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 132967986-926206
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.212 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 103222621-1059561
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.213 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 100731120-2491501
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.214 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 91656097-1014775
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.214 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 67797663-2234205
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.215 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 162482176-2363393
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.215 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 63693687-1078584
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.216 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 81629420-2233400
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.217 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 304738354-1904486
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.217 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 6719009-1142222
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.218 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 147233457-924974
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.219 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 47579698-1070592
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.219 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 136825416-2167976
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.220 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 144197680-977208
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.221 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 166918038-2494188
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.221 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 146334256-899201
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.222 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 9188238-1241135
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.222 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 145174888-1159368
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.223 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 133894192-961476
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.224 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 306642840-652323
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.224 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 0-2242423
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.225 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 249908333-2201375
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.226 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 48650290-1265550
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.226 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 58923129-2424363
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.227 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 78684999-1036809
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.228 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 131729206-1238780
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.228 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 31554861-2371293
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.229 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 33926154-1085348
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.229 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 27060121-2240628
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.230 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 51041701-1107667
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.231 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 120405220-998980
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.231 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 21456247-1296633
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.232 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 62403659-1290028
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.233 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 64772271-1071686
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.233 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 86773758-2477358
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.234 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 130730529-998677
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.235 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 357935762-789629
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.235 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 358725391-781090
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.236 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 252926301-1125965
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.236 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 10429373-1194819
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.237 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 35011502-1274104
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.238 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 307295163-1363030
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.238 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 95574443-2232777
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.239 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 254052266-750213
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.240 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 190089546-2457077
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.240 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 90304630-1351467
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.241 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 23968384-1183663
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.241 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 45184447-2395251
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.242 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 357045680-890082
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.243 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 171435329-867915
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.243 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 22752880-1215504
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.245 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 114598470-2500290
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.245 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 186431498-2288540
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.246 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 37465279-1150328
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.246 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfnatf00.grib2 20356463-1099784
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.247 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfsfcf00.grib2 46791540-2381615
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]                                                              2025-12-17 14:17:22.248 | DEBUG    | earth2studio.data.hrrr:fetch_array:501 - Fetching HRRR grib file: noaa-hrrr-bdp-pds/hrrr.20251216/conus/hrrr.t00z.wrfsfcf00.grib2 0-366063
    Fetching HRRR data:   0%|          | 0/99 [00:00<?, ?it/s]    Fetching HRRR data:   1%|          | 1/99 [00:01<01:44,  1.07s/it]    Fetching HRRR data:   2%|▏         | 2/99 [00:01<00:49,  1.96it/s]    Fetching HRRR data:   7%|▋         | 7/99 [00:01<00:12,  7.65it/s]    Fetching HRRR data:  11%|█         | 11/99 [00:01<00:07, 11.44it/s]    Fetching HRRR data:  16%|█▌        | 16/99 [00:01<00:04, 16.93it/s]    Fetching HRRR data:  19%|█▉        | 19/99 [00:01<00:04, 17.47it/s]    Fetching HRRR data:  22%|██▏       | 22/99 [00:01<00:04, 18.93it/s]    Fetching HRRR data:  26%|██▋       | 26/99 [00:02<00:03, 18.96it/s]    Fetching HRRR data:  31%|███▏      | 31/99 [00:02<00:03, 21.03it/s]    Fetching HRRR data:  36%|███▋      | 36/99 [00:02<00:02, 25.14it/s]    Fetching HRRR data:  39%|███▉      | 39/99 [00:02<00:02, 25.32it/s]    Fetching HRRR data:  42%|████▏     | 42/99 [00:02<00:02, 22.86it/s]    Fetching HRRR data:  46%|████▋     | 46/99 [00:02<00:02, 21.57it/s]    Fetching HRRR data:  49%|████▉     | 49/99 [00:03<00:02, 21.24it/s]    Fetching HRRR data:  53%|█████▎    | 52/99 [00:03<00:03, 12.88it/s]    Fetching HRRR data:  55%|█████▍    | 54/99 [00:03<00:04, 10.00it/s]    Fetching HRRR data:  57%|█████▋    | 56/99 [00:04<00:04,  9.81it/s]    Fetching HRRR data:  60%|█████▉    | 59/99 [00:04<00:04,  9.61it/s]    Fetching HRRR data:  64%|██████▎   | 63/99 [00:04<00:03, 10.82it/s]    Fetching HRRR data:  67%|██████▋   | 66/99 [00:04<00:02, 13.07it/s]    Fetching HRRR data:  69%|██████▊   | 68/99 [00:05<00:03,  9.61it/s]    Fetching HRRR data:  74%|███████▎  | 73/99 [00:05<00:01, 13.64it/s]    Fetching HRRR data:  76%|███████▌  | 75/99 [00:05<00:02, 10.16it/s]    Fetching HRRR data:  81%|████████  | 80/99 [00:06<00:01, 11.52it/s]    Fetching HRRR data:  84%|████████▍ | 83/99 [00:06<00:01, 12.49it/s]    Fetching HRRR data:  86%|████████▌ | 85/99 [00:06<00:01, 11.00it/s]    Fetching HRRR data:  89%|████████▉ | 88/99 [00:07<00:01, 10.39it/s]    Fetching HRRR data:  94%|█████████▍| 93/99 [00:07<00:00, 11.62it/s]    Fetching HRRR data:  98%|█████████▊| 97/99 [00:07<00:00, 12.85it/s]    Fetching HRRR data: 100%|██████████| 99/99 [00:07<00:00, 12.93it/s]
    2025-12-17 14:17:36.180 | SUCCESS  | earth2studio.run:deterministic:106 - Fetched data from HRRR
    2025-12-17 14:17:36.248 | INFO     | earth2studio.run:deterministic:136 - Inference starting!

    Running inference:   0%|          | 0/5 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]                                                         
                                                                    2025-12-17 14:17:38.174 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 388052537-859534
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.177 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 398460732-993086
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.179 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 260196291-556836
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.182 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 200866638-752472
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.184 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 400524863-844581
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.186 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 413291091-965340
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.188 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 414256431-944039
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.190 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 329917562-840568
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.192 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 329012693-904869
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.194 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 253373361-820556
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.197 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 409209736-877463
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.199 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 332135560-1221169
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.201 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 202876378-1168892
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.203 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 206221981-600503
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.204 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 0-1001671
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.206 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 336676903-944643
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.208 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 254193917-725576
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.210 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 206822484-607533
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.212 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 200123392-743246
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.214 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 393012420-966804
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.215 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 335740245-936658
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.217 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 259645170-551121
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.218 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 389936955-1213286
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.219 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 420892538-1173000
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.221 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 256159050-1257461
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]                                                         
                                                                    2025-12-17 14:17:38.222 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f000 393979224-951323
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  20%|██        | 1/5 [00:01<00:06,  1.57s/it]    Fetching GFS data:   4%|▍         | 1/26 [00:00<00:13,  1.91it/s]    Fetching GFS data:   8%|▊         | 2/26 [00:00<00:08,  2.95it/s]    Fetching GFS data:  23%|██▎       | 6/26 [00:00<00:02,  8.94it/s]    Fetching GFS data:  46%|████▌     | 12/26 [00:01<00:00, 18.12it/s]    Fetching GFS data:  65%|██████▌   | 17/26 [00:01<00:00, 23.42it/s]    Fetching GFS data:  85%|████████▍ | 22/26 [00:01<00:00, 27.89it/s]    Fetching GFS data: 100%|██████████| 26/26 [00:01<00:00, 19.46it/s]

    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]                                                         
                                                                    2025-12-17 14:17:51.811 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 332240795-1220414
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.814 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 203793653-1168203
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.816 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 389993217-1213354
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.819 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 416427082-943573
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.821 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 398523373-992489
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.823 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 255138257-729191
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.825 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 261138596-556125
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.827 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 201040592-743226
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.829 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 335843560-935476
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.831 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 254317576-820681
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.833 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 257106216-1257833
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.835 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 260587236-551360
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.837 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 394029626-950310
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.839 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 393064150-965476
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.841 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 428894089-1175828
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.843 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 207738245-607349
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.845 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 0-1000730
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.847 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 330021187-840152
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.849 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 329114366-906821
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.851 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 415462918-964164
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.852 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 400580785-844364
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.854 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 336779036-943716
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.855 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 207137423-600822
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.856 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 409772775-877421
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.857 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 388104660-858526
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]                                                         
                                                                    2025-12-17 14:17:51.859 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f001 201783818-752481
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  40%|████      | 2/5 [00:15<00:26,  8.67s/it]    Fetching GFS data:   4%|▍         | 1/26 [00:00<00:12,  1.99it/s]    Fetching GFS data:   8%|▊         | 2/26 [00:00<00:07,  3.25it/s]    Fetching GFS data:  19%|█▉        | 5/26 [00:00<00:02,  8.79it/s]    Fetching GFS data:  27%|██▋       | 7/26 [00:00<00:01, 10.97it/s]    Fetching GFS data:  58%|█████▊    | 15/26 [00:01<00:00, 24.93it/s]    Fetching GFS data:  73%|███████▎  | 19/26 [00:01<00:00, 27.38it/s]    Fetching GFS data: 100%|██████████| 26/26 [00:01<00:00, 25.33it/s]    Fetching GFS data: 100%|██████████| 26/26 [00:01<00:00, 17.76it/s]

    Running inference:  60%|██████    | 3/5 [00:28<00:21, 10.96s/it]    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]                                                         
                                                                    2025-12-17 14:18:05.498 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 331438957-1220576
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.501 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 204422933-1168507
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.503 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 389161552-1213422
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.505 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 414626634-963993
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.507 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 397690800-991500
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.509 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 254370549-728947
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.511 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 260370698-555642
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.513 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 201669326-742442
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.515 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 335041586-934710
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.517 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 253550875-819674
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.519 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 392234293-965167
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.521 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 256340326-1257869
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.523 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 259819525-551173
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.525 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 393199460-949821
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.527 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 0-1000020
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.529 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 408938986-877455
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.531 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 208090826-607033
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.533 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 399746112-844360
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.535 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 329216904-840046
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.537 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 328313514-903390
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.538 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 415590627-942711
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.539 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 335976296-942630
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.541 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 207490455-600371
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.542 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 428771961-1175538
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.543 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 387268378-859176
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]                                                         
                                                                    2025-12-17 14:18:05.545 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f002 202411768-756230
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  60%|██████    | 3/5 [00:29<00:21, 10.96s/it]    Fetching GFS data:   4%|▍         | 1/26 [00:00<00:11,  2.13it/s]    Fetching GFS data:   8%|▊         | 2/26 [00:00<00:06,  3.48it/s]    Fetching GFS data:  15%|█▌        | 4/26 [00:00<00:03,  6.70it/s]    Fetching GFS data:  31%|███       | 8/26 [00:00<00:01, 14.36it/s]    Fetching GFS data:  50%|█████     | 13/26 [00:00<00:00, 21.90it/s]    Fetching GFS data:  73%|███████▎  | 19/26 [00:01<00:00, 24.56it/s]    Fetching GFS data: 100%|██████████| 26/26 [00:01<00:00, 20.39it/s]

    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]                                                         
                                                                    2025-12-17 14:18:18.902 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 333953322-1217663
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.905 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 204851191-1168744
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.907 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 391730444-1214273
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.910 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 417167657-964257
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.912 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 400236302-987655
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.914 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 256544305-725262
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.916 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 262546627-555813
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.918 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 202100763-742209
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.920 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 337554112-934253
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.922 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 255724373-819932
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.924 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 402289260-844073
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.926 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 258511337-1258302
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.928 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 261996104-550523
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.930 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 395767339-949276
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.932 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 394801585-965754
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.934 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 0-995665
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.936 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 208792561-605814
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.938 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 431466140-1175939
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.940 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 331725610-839707
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.942 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 330823659-901951
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.943 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 418131914-942599
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.944 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 338488365-942162
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.946 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 208192119-600442
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.947 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 411482651-877549
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.948 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 389840674-859256
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]                                                         
                                                                    2025-12-17 14:18:18.949 | DEBUG    | earth2studio.data.gfs:fetch_array:379 - Fetching GFS grib file: noaa-gfs-bdp-pds/gfs.20251216/00/atmos/gfs.t00z.pgrb2.0p25.f003 202842972-752444
    Fetching GFS data:   0%|          | 0/26 [00:00<?, ?it/s]
    Running inference:  80%|████████  | 4/5 [00:42<00:11, 11.91s/it]    Fetching GFS data:   4%|▍         | 1/26 [00:00<00:12,  1.94it/s]    Fetching GFS data:   8%|▊         | 2/26 [00:00<00:07,  3.29it/s]    Fetching GFS data:  19%|█▉        | 5/26 [00:00<00:02,  8.73it/s]    Fetching GFS data:  42%|████▏     | 11/26 [00:00<00:00, 19.69it/s]    Fetching GFS data:  54%|█████▍    | 14/26 [00:01<00:00, 21.25it/s]    Fetching GFS data:  77%|███████▋  | 20/26 [00:01<00:00, 27.96it/s]    Fetching GFS data: 100%|██████████| 26/26 [00:01<00:00, 21.06it/s]

    Running inference: 100%|██████████| 5/5 [00:55<00:00, 12.48s/it]    Running inference: 100%|██████████| 5/5 [00:55<00:00, 11.15s/it]
    2025-12-17 14:18:32.005 | SUCCESS  | earth2studio.run:deterministic:146 - Inference complete
    /
    ├── Z10hl (1, 5, 512, 640) float32
    ├── Z11hl (1, 5, 512, 640) float32
    ├── Z13hl (1, 5, 512, 640) float32
    ├── Z15hl (1, 5, 512, 640) float32
    ├── Z1hl (1, 5, 512, 640) float32
    ├── Z20hl (1, 5, 512, 640) float32
    ├── Z25hl (1, 5, 512, 640) float32
    ├── Z2hl (1, 5, 512, 640) float32
    ├── Z30hl (1, 5, 512, 640) float32
    ├── Z3hl (1, 5, 512, 640) float32
    ├── Z4hl (1, 5, 512, 640) float32
    ├── Z5hl (1, 5, 512, 640) float32
    ├── Z6hl (1, 5, 512, 640) float32
    ├── Z7hl (1, 5, 512, 640) float32
    ├── Z8hl (1, 5, 512, 640) float32
    ├── Z9hl (1, 5, 512, 640) float32
    ├── hrrr_x (640,) float64
    ├── hrrr_y (512,) float64
    ├── lead_time (5,) timedelta64
    ├── mslp (1, 5, 512, 640) float32
    ├── p10hl (1, 5, 512, 640) float32
    ├── p11hl (1, 5, 512, 640) float32
    ├── p13hl (1, 5, 512, 640) float32
    ├── p15hl (1, 5, 512, 640) float32
    ├── p1hl (1, 5, 512, 640) float32
    ├── p20hl (1, 5, 512, 640) float32
    ├── p2hl (1, 5, 512, 640) float32
    ├── p3hl (1, 5, 512, 640) float32
    ├── p4hl (1, 5, 512, 640) float32
    ├── p5hl (1, 5, 512, 640) float32
    ├── p6hl (1, 5, 512, 640) float32
    ├── p7hl (1, 5, 512, 640) float32
    ├── p8hl (1, 5, 512, 640) float32
    ├── p9hl (1, 5, 512, 640) float32
    ├── q10hl (1, 5, 512, 640) float32
    ├── q11hl (1, 5, 512, 640) float32
    ├── q13hl (1, 5, 512, 640) float32
    ├── q15hl (1, 5, 512, 640) float32
    ├── q1hl (1, 5, 512, 640) float32
    ├── q20hl (1, 5, 512, 640) float32
    ├── q25hl (1, 5, 512, 640) float32
    ├── q2hl (1, 5, 512, 640) float32
    ├── q30hl (1, 5, 512, 640) float32
    ├── q3hl (1, 5, 512, 640) float32
    ├── q4hl (1, 5, 512, 640) float32
    ├── q5hl (1, 5, 512, 640) float32
    ├── q6hl (1, 5, 512, 640) float32
    ├── q7hl (1, 5, 512, 640) float32
    ├── q8hl (1, 5, 512, 640) float32
    ├── q9hl (1, 5, 512, 640) float32
    ├── refc (1, 5, 512, 640) float32
    ├── t10hl (1, 5, 512, 640) float32
    ├── t11hl (1, 5, 512, 640) float32
    ├── t13hl (1, 5, 512, 640) float32
    ├── t15hl (1, 5, 512, 640) float32
    ├── t1hl (1, 5, 512, 640) float32
    ├── t20hl (1, 5, 512, 640) float32
    ├── t25hl (1, 5, 512, 640) float32
    ├── t2hl (1, 5, 512, 640) float32
    ├── t2m (1, 5, 512, 640) float32
    ├── t30hl (1, 5, 512, 640) float32
    ├── t3hl (1, 5, 512, 640) float32
    ├── t4hl (1, 5, 512, 640) float32
    ├── t5hl (1, 5, 512, 640) float32
    ├── t6hl (1, 5, 512, 640) float32
    ├── t7hl (1, 5, 512, 640) float32
    ├── t8hl (1, 5, 512, 640) float32
    ├── t9hl (1, 5, 512, 640) float32
    ├── time (1,) datetime64
    ├── u10hl (1, 5, 512, 640) float32
    ├── u10m (1, 5, 512, 640) float32
    ├── u11hl (1, 5, 512, 640) float32
    ├── u13hl (1, 5, 512, 640) float32
    ├── u15hl (1, 5, 512, 640) float32
    ├── u1hl (1, 5, 512, 640) float32
    ├── u20hl (1, 5, 512, 640) float32
    ├── u25hl (1, 5, 512, 640) float32
    ├── u2hl (1, 5, 512, 640) float32
    ├── u30hl (1, 5, 512, 640) float32
    ├── u3hl (1, 5, 512, 640) float32
    ├── u4hl (1, 5, 512, 640) float32
    ├── u5hl (1, 5, 512, 640) float32
    ├── u6hl (1, 5, 512, 640) float32
    ├── u7hl (1, 5, 512, 640) float32
    ├── u8hl (1, 5, 512, 640) float32
    ├── u9hl (1, 5, 512, 640) float32
    ├── v10hl (1, 5, 512, 640) float32
    ├── v10m (1, 5, 512, 640) float32
    ├── v11hl (1, 5, 512, 640) float32
    ├── v13hl (1, 5, 512, 640) float32
    ├── v15hl (1, 5, 512, 640) float32
    ├── v1hl (1, 5, 512, 640) float32
    ├── v20hl (1, 5, 512, 640) float32
    ├── v25hl (1, 5, 512, 640) float32
    ├── v2hl (1, 5, 512, 640) float32
    ├── v30hl (1, 5, 512, 640) float32
    ├── v3hl (1, 5, 512, 640) float32
    ├── v4hl (1, 5, 512, 640) float32
    ├── v5hl (1, 5, 512, 640) float32
    ├── v6hl (1, 5, 512, 640) float32
    ├── v7hl (1, 5, 512, 640) float32
    ├── v8hl (1, 5, 512, 640) float32
    └── v9hl (1, 5, 512, 640) float32





.. GENERATED FROM PYTHON SOURCE LINES 114-121

Post Processing
---------------
The last step is to post process our results. Cartopy is a great library for plotting
fields on projections of a sphere. Here we will just plot the temperature at 2 meters
(t2m) 4 hours into the forecast.

Notice that the Zarr IO function has additional APIs to interact with the stored data.

.. GENERATED FROM PYTHON SOURCE LINES 123-165

.. code-block:: Python

    import cartopy
    import cartopy.crs as ccrs
    import matplotlib.pyplot as plt

    forecast = f"{date}"
    variable = "t2m"
    step = 4  # lead time = 1 hr

    plt.close("all")

    # Create a correct Lambert Conformal projection
    projection = ccrs.LambertConformal(
        central_longitude=262.5,
        central_latitude=38.5,
        standard_parallels=(38.5, 38.5),
        globe=ccrs.Globe(semimajor_axis=6371229, semiminor_axis=6371229),
    )

    # Create a figure and axes with the specified projection
    fig, ax = plt.subplots(subplot_kw={"projection": projection}, figsize=(10, 6))

    # Plot the field using pcolormesh
    im = ax.pcolormesh(
        model.lon,
        model.lat,
        io[variable][0, step],
        transform=ccrs.PlateCarree(),
        cmap="Spectral_r",
    )

    # Set state lines
    ax.add_feature(
        cartopy.feature.STATES.with_scale("50m"), linewidth=0.5, edgecolor="black", zorder=2
    )

    # Set title
    ax.set_title(f"{forecast} - Lead time: {step}hrs")

    # Add coastlines and gridlines
    ax.coastlines()
    ax.gridlines()
    plt.savefig(f"outputs/09_{date}_t2m_prediction.jpg")



.. image-sg:: /examples/images/sphx_glr_09_stormcast_example_001.png
   :alt: 2025-12-16 - Lead time: 4hrs
   :srcset: /examples/images/sphx_glr_09_stormcast_example_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (1 minutes 26.014 seconds)


.. _sphx_glr_download_examples_09_stormcast_example.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: 09_stormcast_example.ipynb <09_stormcast_example.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: 09_stormcast_example.py <09_stormcast_example.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: 09_stormcast_example.zip <09_stormcast_example.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
