
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../_static/favicon.ico" rel="icon" type="image/x-icon">
    <title>Distributed Manager Inference &#8212; Earth2Studio 0.8.0a0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/nvidia-sphinx-theme.css?v=418c9516" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=96f8bfd3"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/08_distributed_manager';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/NVIDIA/earth2studio/gh-pages/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'main';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Running StormCast Inference" href="09_stormcast_example.html" />
    <link rel="prev" title="Statistical Inference" href="07_seasonal_statistics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.8" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/NVIDIA-Logo-V-ForScreen-ForLightBG.png" class="logo__image only-light" alt=""/>
    <img src="../_static/NVIDIA-Logo-V-ForScreen-ForDarkBG.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">Earth2Studio</p>
  
</a></div>
    
      <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../userguide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../modules/index.html">
    API
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/NVIDIA/earth2studio/tree/main/recipes">
    Recipes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/NVIDIA/earth2studio/blob/main/CHANGELOG.md">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/earth2studio" title="Github" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Github</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../userguide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../modules/index.html">
    API
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/NVIDIA/earth2studio/tree/main/recipes">
    Recipes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/NVIDIA/earth2studio/blob/main/CHANGELOG.md">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/earth2studio" title="Github" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Github</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_deterministic_workflow.html">Running Deterministic Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_diagnostic_workflow.html">Running Diagnostic Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_ensemble_workflow.html">Running Ensemble Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_corrdiff_inference.html">Generative Downscaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_ensemble_workflow_extend.html">Single Variable Perturbation Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_model_perturbation_hook.html">Model Hook Injection: Perturbation</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_seasonal_statistics.html">Statistical Inference</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Distributed Manager Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_stormcast_example.html">Running StormCast Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_stormcast_ensemble_example.html">Running StormCast Ensemble Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_huge_ensembles.html">Huge Ensembles (HENS) Checkpoints</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_temporal_interpolation.html">Temporal Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_cyclone_tracking.html">Tropical Cyclone Tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_dlesym_example.html">Running DLESyM Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_cbottle_generation.html">cBottle Data Generation and Infilling</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="extend/index.html">Extending Earth2Studio</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="extend/01_custom_prognostic.html">Extending Prognostic Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="extend/02_custom_diagnostic.html">Extending Diagnostic Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="extend/03_custom_datasource.html">Extending Data Sources</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Distributed Manager Inference</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-08-distributed-manager-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="distributed-manager-inference">
<span id="sphx-glr-examples-08-distributed-manager-py"></span><h1>Distributed Manager Inference<a class="headerlink" href="#distributed-manager-inference" title="Link to this heading">#</a></h1>
<p>Setting up distributed manager for parallel inference.</p>
<p>Many inference workflows are embarrassingly parallel and can be easily sharded across
multiple devices.
This example demonstrates how one can use the PhysicsNeMo distributed manager to distribute
inference across mutliple GPUs.
The <a class="reference external" href="https://github.com/NVIDIA/physicsnemo/blob/main/physicsnemo/distributed/manager.py">distributed manager</a>
is a utility that provides a useful set of properties that pertain to a parallel
environment.</p>
<p>In this example you will learn:</p>
<ul class="simple">
<li><p>How to use the distributed manager to access parallel environment properties</p></li>
<li><p>Parallelize deterministic inference across multiple initial date-times</p></li>
<li><p>Limitations of parallel inference in Earth2Studio</p></li>
<li><p>Post-processing strategies of parallel job outputs</p></li>
</ul>
<section id="set-up">
<h2>Set Up<a class="headerlink" href="#set-up" title="Link to this heading">#</a></h2>
<p>Set up the distributed manager by initializing it. Out of the box, the distributed
manager supports MPI, SLURM and PyTorch parallel environments which provide information
regarding the parallel enviroment but environment variables.</p>
<p>For example, this script could be ran using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># OpenMPI</span>
mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">2</span><span class="w"> </span>python<span class="w"> </span>08_distributed_manager.py
<span class="c1"># Torch run</span>
torchrun<span class="w"> </span>--standalone<span class="w"> </span>--nnodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>--nproc-per-node<span class="o">=</span><span class="m">2</span><span class="w"> </span>08_distributed_manager.py
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When running in parallel, make sure the .env file in the repository examples
folder is <em>not</em> present. The .env file is intended for the documentation build only.</p>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;outputs&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dotenv</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dotenv</span>

<span class="n">load_dotenv</span><span class="p">()</span>  <span class="c1"># TODO: make common example prep function</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">loguru</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">physicsnemo.distributed</span><span class="w"> </span><span class="kn">import</span> <span class="n">DistributedManager</span>

<span class="n">DistributedManager</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>  <span class="c1"># Only call this once in the entire script!</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">DistributedManager</span><span class="p">()</span>
<span class="k">assert</span> <span class="p">(</span>  <span class="c1"># noqa: S101</span>
    <span class="n">dist</span><span class="o">.</span><span class="n">_distributed</span>
<span class="p">),</span> <span class="s2">&quot;Looks like torch distributed isn&#39;t set up. Check your env variables!&quot;</span>

<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Inference runner </span><span class="si">{</span><span class="n">dist</span><span class="o">.</span><span class="n">rank</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">dist</span><span class="o">.</span><span class="n">world_size</span><span class="si">}</span><span class="s2"> with device </span><span class="si">{</span><span class="n">dist</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2025-06-09 03:14:43.050 | INFO     | __main__:&lt;module&gt;:80 - Inference runner 0 of 1 with device cuda:0
</pre></div>
</div>
<p>Next the needed components get initialized.
Rigorous parallel support is not part of Earth2Studio’s design goals, there are some
spots where potential race conditions can occur. Thus some additional care should be
taken to ensure safe parallel inference.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">earth2studio.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">WB2ERA5</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">earth2studio.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">ZarrBackend</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">earth2studio.models.px</span><span class="w"> </span><span class="kn">import</span> <span class="n">DLWP</span>

<span class="c1"># Load model</span>
<span class="n">package</span> <span class="o">=</span> <span class="n">DLWP</span><span class="o">.</span><span class="n">load_default_package</span><span class="p">()</span>
<span class="k">if</span> <span class="n">dist</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">DLWP</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>

<span class="n">torch</span><span class="o">.</span><span class="n">distributed</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="k">if</span> <span class="n">dist</span><span class="o">.</span><span class="n">rank</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">DLWP</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
</pre></div>
</div>
<p>When loading models that are built into Earth2Studio, the model’s checkpoint files
will be downloaded into the machines cache. If each inference process has access to
the same cache location, then only one should download the checkpoint triggered by
<code class="xref py py-func docutils literal notranslate"><span class="pre">load_model()</span></code>.</p>
<p>Here <a class="reference internal" href="../modules/generated/models/px/earth2studio.models.px.DLWP.html#earth2studio.models.px.DLWP" title="earth2studio.models.px.DLWP"><code class="xref py py-class docutils literal notranslate"><span class="pre">earth2studio.models.px.DLWP</span></code></a> checkpoint files are first downloaded by
process 0 and then loaded by other processes.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the data source</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">WB2ERA5</span><span class="p">()</span>
</pre></div>
</div>
<p>The remote date store will place cached data into separate caches for each process.
This makes the download of initial state data safe during parallel inference but also
means that multiple jobs will download the same date-time if needed.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;lead_time&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">ZarrBackend</span><span class="p">(</span>
    <span class="n">file_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;outputs/08_output_</span><span class="si">{</span><span class="n">dist</span><span class="o">.</span><span class="n">rank</span><span class="si">}</span><span class="s2">.zarr&quot;</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
    <span class="n">backend_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;overwrite&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Earth2Studio does not provide distributed IO support. The recommendation is to always
output data for each process to a separate file, then aggregate the data during post
processing.</p>
</section>
<section id="execute-the-workflow">
<h2>Execute the Workflow<a class="headerlink" href="#execute-the-workflow" title="Link to this heading">#</a></h2>
<p>Next we can run the workflow. This example will run inference for a random date across
several years and just save total column water vapor. Shard the initial date-times
across the each process. The distributed manager will provide the device ID for the
process.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">earth2studio.run</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">run</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;200</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">-06-01T00:00:00&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)])</span>
<span class="k">assert</span> <span class="p">(</span>  <span class="c1"># noqa: S101</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">dist</span><span class="o">.</span><span class="n">world_size</span>
<span class="p">),</span> <span class="s2">&quot;Inference runs should be greater than processes&quot;</span>
<span class="n">time_shard</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">world_size</span><span class="p">)[</span><span class="n">dist</span><span class="o">.</span><span class="n">rank</span><span class="p">]</span>

<span class="n">nsteps</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">output_coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;tcwv&quot;</span><span class="p">])}</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">deterministic</span><span class="p">(</span>
    <span class="n">time_shard</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">io</span><span class="p">,</span> <span class="n">output_coords</span><span class="o">=</span><span class="n">output_coords</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">device</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">tree</span><span class="p">())</span>
<span class="n">torch</span><span class="o">.</span><span class="n">distributed</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2025-06-09 03:14:44.130 | INFO     | earth2studio.run:deterministic:75 - Running simple workflow!
2025-06-09 03:14:44.130 | INFO     | earth2studio.run:deterministic:82 - Inference device: cuda:0
2025-06-09 03:14:44.372 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/.zattrs to local cache
2025-06-09 03:14:44.624 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/.zgroup to local cache
2025-06-09 03:14:44.625 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/.zmetadata to local cache
2025-06-09 03:14:44.930 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/level/0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.084 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t850 at 2002-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.085 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z300 at 2002-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.086 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z300 at 2003-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.087 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z1000 at 2000-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.088 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t2m at 2000-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.089 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t2m at 2001-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.090 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z300 at 2005-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.091 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z1000 at 2003-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.092 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z500 at 2002-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.093 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t850 at 2005-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.094 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z500 at 2005-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.096 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t850 at 2001-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.097 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: tcwv at 2000-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.099 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z300 at 2004-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.100 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z1000 at 2004-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.101 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z1000 at 2002-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.102 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z500 at 2001-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.103 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: tcwv at 2005-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.104 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t2m at 2004-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.105 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t850 at 2003-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.107 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z1000 at 2001-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.108 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: tcwv at 2001-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.109 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: tcwv at 2002-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.110 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z500 at 2000-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.111 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z700 at 2002-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.112 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t850 at 2004-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.113 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z700 at 2005-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.115 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: tcwv at 2004-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.116 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z700 at 2000-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.118 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t2m at 2003-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.118 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t2m at 2002-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.120 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z1000 at 2005-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.121 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z300 at 2001-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.122 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z500 at 2003-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.123 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t850 at 2000-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.126 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z700 at 2003-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.129 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z500 at 2004-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.132 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z300 at 2000-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.136 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z700 at 2001-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.139 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z700 at 2004-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.142 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t2m at 2005-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.145 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: tcwv at 2003-05-31T18:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.310 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/63427.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.310 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/64887.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.312 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/temperature/63427.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.319 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/67811.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.333 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/63427.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.336 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/64887.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.345 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/60507.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.347 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/61967.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.358 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/2m_temperature/61967.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.359 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/total_column_water_vapour/63427.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.360 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/2m_temperature/63427.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.368 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/total_column_water_vapour/67811.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.371 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/61967.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.379 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/60507.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.380 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/67811.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.381 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/67811.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.382 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/66351.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.383 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/60507.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.383 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/63427.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.384 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/66351.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.385 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/64887.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.386 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/67811.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.387 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/total_column_water_vapour/64887.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.388 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/63427.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.388 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/total_column_water_vapour/66351.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.389 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/61967.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.389 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/60507.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.390 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/64887.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.391 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/temperature/64887.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.391 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/66351.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.392 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/61967.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.393 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/2m_temperature/67811.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.394 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/2m_temperature/66351.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.395 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/temperature/67811.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.395 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/temperature/61967.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.396 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/temperature/60507.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.397 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/temperature/66351.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.398 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/66351.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.398 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/2m_temperature/60507.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.401 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/2m_temperature/64887.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.419 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/total_column_water_vapour/61967.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:45.444 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/total_column_water_vapour/60507.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]
Fetching WB2 data:   2%|▏         | 1/42 [00:00&lt;00:36,  1.14it/s]
Fetching WB2 data:  14%|█▍        | 6/42 [00:00&lt;00:04,  7.95it/s]
Fetching WB2 data:  24%|██▍       | 10/42 [00:01&lt;00:02, 12.82it/s]
Fetching WB2 data:  33%|███▎      | 14/42 [00:02&lt;00:04,  6.19it/s]
Fetching WB2 data:  40%|████      | 17/42 [00:02&lt;00:03,  7.19it/s]
Fetching WB2 data:  48%|████▊     | 20/42 [00:02&lt;00:02,  8.40it/s]
Fetching WB2 data:  67%|██████▋   | 28/42 [00:02&lt;00:00, 16.02it/s]
Fetching WB2 data:  81%|████████  | 34/42 [00:02&lt;00:00, 21.82it/s]
Fetching WB2 data:  93%|█████████▎| 39/42 [00:03&lt;00:00, 20.88it/s]
Fetching WB2 data: 100%|██████████| 42/42 [00:03&lt;00:00, 12.61it/s]

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.417 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t850 at 2001-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.418 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z300 at 2002-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.419 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z300 at 2003-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.419 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z1000 at 2000-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.420 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t2m at 2000-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.420 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t2m at 2001-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.421 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z300 at 2005-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.422 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z1000 at 2003-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.422 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z500 at 2002-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.423 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t850 at 2003-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.423 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z500 at 2005-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.424 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t850 at 2002-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.424 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: tcwv at 2000-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.425 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z300 at 2004-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.425 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z1000 at 2004-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.426 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z1000 at 2002-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.426 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z500 at 2001-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.427 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: tcwv at 2005-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.427 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t2m at 2004-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.428 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t850 at 2000-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.428 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z1000 at 2001-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.429 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: tcwv at 2001-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.429 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: tcwv at 2002-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.429 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z500 at 2000-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.430 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z700 at 2002-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.430 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t850 at 2005-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.431 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z700 at 2005-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.431 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: tcwv at 2004-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.432 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z700 at 2000-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.432 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t2m at 2003-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.433 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t2m at 2002-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.433 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z1000 at 2005-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.434 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z300 at 2001-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.434 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z500 at 2003-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.435 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t850 at 2004-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.435 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z700 at 2003-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.436 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z500 at 2004-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.436 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z300 at 2000-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.437 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z700 at 2001-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.437 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: z700 at 2004-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.438 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: t2m at 2005-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.438 | DEBUG    | earth2studio.data.wb2:fetch_array:222 - Fetching WB2 zarr array for variable: tcwv at 2003-06-01T00:00:00

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.507 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/2m_temperature/60508.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.508 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/64888.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.508 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/temperature/61968.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.509 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/2m_temperature/61968.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.509 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/66352.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.509 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/2m_temperature/66352.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.510 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/63428.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.511 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/total_column_water_vapour/63428.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.511 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/67812.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.511 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/temperature/63428.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.512 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/67812.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.512 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/60508.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.513 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/64888.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.513 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/total_column_water_vapour/60508.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.514 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/2m_temperature/63428.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.514 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/total_column_water_vapour/67812.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.514 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/63428.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.515 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/temperature/64888.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.515 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/total_column_water_vapour/66352.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.516 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/60508.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.516 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/66352.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.517 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/61968.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.517 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/63428.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.517 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/61968.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.518 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/66352.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.518 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/61968.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.518 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/temperature/60508.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.519 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/64888.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.519 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/2m_temperature/67812.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.520 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/67812.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.520 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/total_column_water_vapour/61968.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.520 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/67812.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.521 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/2m_temperature/64888.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.523 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/64888.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.524 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/temperature/66352.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.525 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/total_column_water_vapour/64888.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.527 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/temperature/67812.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.532 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/60508.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.534 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/66352.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.535 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/60508.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.537 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/63428.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]

2025-06-09 03:14:48.577 | DEBUG    | earth2studio.data.utils:_make_local_details:629 - Copying /weatherbench2/datasets/era5/1959-2023_01_10-wb13-6h-1440x721_with_derived_variables.zarr/geopotential/61968.0.0.0 to local cache

Fetching WB2 data:   0%|          | 0/42 [00:00&lt;?, ?it/s]
Fetching WB2 data:   2%|▏         | 1/42 [00:00&lt;00:14,  2.85it/s]
Fetching WB2 data:  17%|█▋        | 7/42 [00:00&lt;00:01, 19.07it/s]
Fetching WB2 data:  26%|██▌       | 11/42 [00:00&lt;00:01, 23.43it/s]
Fetching WB2 data:  36%|███▌      | 15/42 [00:01&lt;00:04,  6.66it/s]
Fetching WB2 data:  43%|████▎     | 18/42 [00:02&lt;00:02,  8.15it/s]
Fetching WB2 data:  50%|█████     | 21/42 [00:02&lt;00:02, 10.29it/s]
Fetching WB2 data:  57%|█████▋    | 24/42 [00:02&lt;00:01, 12.29it/s]
Fetching WB2 data:  79%|███████▊  | 33/42 [00:02&lt;00:00, 21.01it/s]
Fetching WB2 data:  93%|█████████▎| 39/42 [00:02&lt;00:00, 20.86it/s]
Fetching WB2 data: 100%|██████████| 42/42 [00:03&lt;00:00, 14.75it/s]
Fetching WB2 data: 100%|██████████| 42/42 [00:03&lt;00:00, 13.20it/s]
2025-06-09 03:14:51.789 | SUCCESS  | earth2studio.run:deterministic:106 - Fetched data from WB2ERA5
2025-06-09 03:14:51.793 | WARNING  | earth2studio.io.zarr:add_array:192 - Datetime64 not supported in zarr 3.0, converting to int64 nanoseconds since epoch
2025-06-09 03:14:51.797 | WARNING  | earth2studio.io.zarr:add_array:198 - Timedelta64 not supported in zarr 3.0, converting to int64 nanoseconds since epoch
2025-06-09 03:14:51.809 | INFO     | earth2studio.run:deterministic:136 - Inference starting!


Running inference:   0%|          | 0/21 [00:00&lt;?, ?it/s]

Running inference:   5%|▍         | 1/21 [00:00&lt;00:05,  3.61it/s]

Running inference:  10%|▉         | 2/21 [00:00&lt;00:05,  3.46it/s]

Running inference:  14%|█▍        | 3/21 [00:00&lt;00:04,  3.75it/s]

Running inference:  19%|█▉        | 4/21 [00:01&lt;00:04,  3.59it/s]

Running inference:  24%|██▍       | 5/21 [00:01&lt;00:04,  3.58it/s]

Running inference:  29%|██▊       | 6/21 [00:01&lt;00:04,  3.52it/s]

Running inference:  33%|███▎      | 7/21 [00:01&lt;00:03,  3.56it/s]

Running inference:  38%|███▊      | 8/21 [00:02&lt;00:03,  3.54it/s]

Running inference:  43%|████▎     | 9/21 [00:02&lt;00:03,  3.61it/s]

Running inference:  48%|████▊     | 10/21 [00:02&lt;00:03,  3.57it/s]

Running inference:  52%|█████▏    | 11/21 [00:03&lt;00:02,  3.59it/s]

Running inference:  57%|█████▋    | 12/21 [00:03&lt;00:02,  3.54it/s]

Running inference:  62%|██████▏   | 13/21 [00:03&lt;00:02,  3.60it/s]

Running inference:  67%|██████▋   | 14/21 [00:03&lt;00:01,  3.56it/s]

Running inference:  71%|███████▏  | 15/21 [00:04&lt;00:01,  3.53it/s]

Running inference:  76%|███████▌  | 16/21 [00:04&lt;00:01,  3.43it/s]

Running inference:  81%|████████  | 17/21 [00:04&lt;00:01,  3.49it/s]

Running inference:  86%|████████▌ | 18/21 [00:05&lt;00:00,  3.50it/s]

Running inference:  90%|█████████ | 19/21 [00:05&lt;00:00,  3.54it/s]

Running inference:  95%|█████████▌| 20/21 [00:05&lt;00:00,  3.52it/s]

Running inference: 100%|██████████| 21/21 [00:05&lt;00:00,  3.56it/s]
Running inference: 100%|██████████| 21/21 [00:05&lt;00:00,  3.55it/s]
2025-06-09 03:14:57.722 | SUCCESS  | earth2studio.run:deterministic:146 - Inference complete
/
├── lat (721,) float64
├── lead_time (21,) int64
├── lon (1440,) float64
├── tcwv (6, 21, 721, 1440) float32
└── time (6,) int64
</pre></div>
</div>
</section>
<section id="post-processing">
<h2>Post Processing<a class="headerlink" href="#post-processing" title="Link to this heading">#</a></h2>
<p>Finally, we can post process the results. Xarray provides a useful function for
opening multiple files as a single dataset, <code class="xref py py-func docutils literal notranslate"><span class="pre">xarray.open_mfdataset()</span></code>. This
allows outputs from all processes to get treated as a single data array.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In this script process 0 is used to post process so the example is in one file.
It is best practice to perform post processing in a separate job / script entirely
to better utilize compute resources.</p>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">dist</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">earth2studio.utils.time</span><span class="w"> </span><span class="kn">import</span> <span class="n">timearray_to_datetime</span>

    <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;outputs/08_output_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.zarr&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">world_size</span><span class="p">)]</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s2">&quot;nested&quot;</span><span class="p">,</span> <span class="n">concat_dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;zarr&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

    <span class="n">ncols</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">time</span> <span class="o">=</span> <span class="n">timearray_to_datetime</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;datetime64[ns]&quot;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="n">ncols</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
            <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;tcwv&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">lead_time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gist_earth&quot;</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="n">ncols</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m/</span><span class="si">%d</span><span class="s2">/%Y&quot;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;TCWV Forecast Lead Time - </span><span class="si">{</span><span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;lead_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;timedelta64[ns]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;timedelta64[D]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="si">}</span><span class="s1"> days&#39;</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;outputs/08_tcwv_distributed_manager.jpg&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_08_distributed_manager_001.png" srcset="../_images/sphx_glr_08_distributed_manager_001.png" alt="TCWV Forecast Lead Time - 5 days, 06/01/2000, 06/01/2001, 06/01/2002, 06/01/2003, 06/01/2004, 06/01/2005" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;xarray.Dataset&gt; Size: 523MB
Dimensions:    (time: 6, lead_time: 21, lat: 721, lon: 1440)
Coordinates:
  * lead_time  (lead_time) int64 168B 0 21600000000000 ... 432000000000000
  * lat        (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * time       (time) int64 48B 959817600000000000 ... 1117584000000000000
  * lon        (lon) float64 12kB 0.0 0.25 0.5 0.75 ... 359.0 359.2 359.5 359.8
Data variables:
    tcwv       (time, lead_time, lat, lon) float32 523MB dask.array&lt;chunksize=(1, 1, 721, 1440), meta=np.ndarray&gt;
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 16.078 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-08-distributed-manager-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/ca04ad2383a05ecb3fa754752819cc0d/08_distributed_manager.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">08_distributed_manager.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/a44b6f18f6d87dffa6e2374486617d8e/08_distributed_manager.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">08_distributed_manager.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/209e9c13688cd911925be547c2e03596/08_distributed_manager.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">08_distributed_manager.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="07_seasonal_statistics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Statistical Inference</p>
      </div>
    </a>
    <a class="right-next"
       href="09_stormcast_example.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Running StormCast Inference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up">Set Up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execute-the-workflow">Execute the Workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing">Post Processing</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/08_distributed_manager.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, NVIDIA.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>